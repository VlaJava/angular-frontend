<div class="admin-container">

  <div class="image-column">
    
    <div class="image-preview-container">
      <img *ngIf="imagePreview" [src]="imagePreview" alt="Preview da nova imagem">
      <img *ngIf="!imagePreview && package?.imageUrl" [src]="package?.imageUrl" alt="Imagem do pacote {{ package?.title }}">
      <div *ngIf="!imagePreview && !package?.imageUrl" class="image-placeholder">
        <span>Sem Imagem</span>
      </div>
    </div>
    <div class="upload-section">
      <input type="file" #fileInput hidden (change)="onFileSelected($event)" accept="image/png, image/jpeg">
      <button type="button" class="btn btn-warning" (click)="fileInput.click()">
        {{ package?.imageUrl ? 'Trocar Imagem' : 'Adicionar Imagem' }}
      </button>
      <button *ngIf="selectedFile" type="button" class="btn btn-primary" (click)="onUploadImage()">
        Enviar Nova Imagem
      </button>
    </div>
  </div>

  <div class="details-column">
    <ng-container *ngIf="!isEditing">
      <h2>{{ package?.title }}</h2>
      <span class="badge" [class.available]="package?.available" [class.unavailable]="!package?.available">
        {{ package?.available ? 'Disponível' : 'Indisponível' }}
      </span>
      <p class="description">{{ package?.description }}</p>
      <div class="details-grid">
        <div><strong>Origem:</strong> {{ package?.source }}</div>
        <div><strong>Destino:</strong> {{ package?.destination }}</div>
        <div><strong>Preço:</strong> {{ package?.price | currency:'BRL' }}</div>
        <div><strong>Limite:</strong> {{ package?.travelerLimit }} viajantes</div>
        <div><strong>Início:</strong> {{ package?.startDate | date:'dd/MM/yyyy' }}</div>
        <div><strong>Fim:</strong> {{ package?.endDate | date:'dd/MM/yyyy' }}</div>
      </div>
    </ng-container>

    <ng-container *ngIf="isEditing">
      <form [formGroup]="packageForm" (ngSubmit)="onSave()">
        
        <div class="form-group">
          <label for="title">Título</label>
          <input id="title" type="text" formControlName="title">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="source">Origem</label>
            <input id="source" type="text" formControlName="source">
          </div>
          <div class="form-group">
            <label for="destination">Destino</label>
            <input id="destination" type="text" formControlName="destination">
          </div>
        </div>
        <div class="form-group">
          <label for="description">Descrição</label>
          <textarea id="description" rows="3" formControlName="description"></textarea>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="price">Preço</label>
                <input id="price" type="number" formControlName="price">
            </div>
            <div class="form-group">
                <label for="travelerLimit">Limite de Viajantes</label>
                <input id="travelerLimit" type="number" formControlName="travelerLimit">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="startDate">Data de Início</label>
                <input id="startDate" type="date" formControlName="startDate">
            </div>
            <div class="form-group">
                <label for="endDate">Data Final</label>
                <input id="endDate" type="date" formControlName="endDate">
            </div>
        </div>
        <div class="form-group checkbox-group">
          <input id="available" type="checkbox" formControlName="available">
          <label for="available">Disponível</label>
        </div>
      </form>
    </ng-container>

    <div class="actions-section">
      
      <div *ngIf="!isEditing" class="action-buttons">
        <a routerLink="/admin/packages" class="btn btn-secondary">Voltar</a>
        <button class="btn btn-warning" (click)="enterEditMode()">Editar Informações</button>
        <button class="btn btn-danger" (click)="onDelete()">Excluir Pacote</button>
      </div>
      <div *ngIf="isEditing" class="action-buttons">
        <button class="btn btn-secondary" (click)="cancelEditMode()">Cancelar</button>
        <button class="btn btn-warning" (click)="onSave()" [disabled]="packageForm.invalid">Salvar Alterações</button>
      </div>
    </div>
  </div>
</div>